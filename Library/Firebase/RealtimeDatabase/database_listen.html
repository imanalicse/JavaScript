<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Listen database</title>
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-database-compat.js"></script>
    <script src="../firebase_config.js"></script>
    <script src="../firebase_common.js"></script>
</head>
<body>

<script>
    const firebaseConfig = FIREBASE_CONFIG;
    const firebaseApp = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const databaseRef = database.ref();
    const presentationRef  = database.ref(`presentation`);

    /*
    presentationRef.on('value', (snapshot) => {
        console.log('called on value')
        const data = snapshot.val();
        updateUI(data);
    });
    */

    presentationRef.on('child_added', (snapshot) => {
        console.log('child_added - called')
        const data = snapshot.val();
        updateUI(data);
    });

    presentationRef.on('child_changed', (snapshot) => {
        console.log('child_changed - called')
        const data = snapshot.val();
        updateUI(data);
    });

    presentationRef.on('child_removed', (snapshot) => {
        console.log('child_removed - called')
        const data = snapshot.val();
        updateUI(data);
    });

    
    function updateUI(data) {
        console.log('data===', data);
        Object.keys(data).forEach(key => {
            const item = data[key];
            console.log(key + ': ', item)
        });
    }

    /*
    import { getDatabase, push, ref, onValue, set, onChildChanged} from 'https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js'
    // Initialize Firebase
    const firebaseApp = initializeApp(firebaseConfig);
    const database = getDatabase();

    const dbRef       = ref(database,  `presentation`)
    onChildChanged(dbRef, (snapshot)=> {
        const data = snapshot.val();
        console.log('data', data)
    })
    */

</script>

</body>
</html>